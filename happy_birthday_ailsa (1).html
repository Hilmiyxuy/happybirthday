<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ultimate ‚Äî Happy Birthday Ailsa</title>

  <!-- Tailwind for quick utilities (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Particles + Confetti libs (keamanan: CDN, offline bisa ganti) -->
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/confetti-js@0.0.18/dist/index.min.js"></script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --pink-1:#fff0f6;
      --pink-2:#fff6fb;
      --accent:#f472b6;
      --glass: rgba(255,255,255,0.92);
    }

    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter, 'Poppins', sans-serif;
      overflow-x:hidden;
      background:linear-gradient(135deg,var(--pink-1),var(--pink-2));
    }

    /* animated gradient background (subtle, moves slowly) */
    .animated-bg{
      position:fixed;inset:0;z-index:-30;
      background:linear-gradient(120deg,#ffdee9 0%, #b5ffd3 50%, #dcd0ff 100%);
      background-size: 300% 300%;
      animation: bgShift 18s ease-in-out infinite;
      filter: saturate(1.05) blur(0.6px);
    }
    @keyframes bgShift{
      0%{background-position:0% 50%}
      50%{background-position:100% 50%}
      100%{background-position:0% 50%}
    }

    /* dreamy bokeh overlay */
    .bokeh{
      position:fixed;inset:0;z-index:-20;pointer-events:none;
      background-image:
        radial-gradient(circle at 10% 20%, rgba(255,255,255,0.08) 0 8%, transparent 20%),
        radial-gradient(circle at 80% 70%, rgba(255,200,240,0.06) 0 12%, transparent 25%),
        radial-gradient(circle at 50% 45%, rgba(200,230,255,0.04) 0 10%, transparent 25%);
      filter: blur(18px) contrast(0.95);
      opacity:0.95;
      mix-blend-mode:screen;
    }

    .center{display:flex;align-items:center;justify-content:center}
    .handwritten{font-family:'Great Vibes',cursive}
    .popup-card{
      background:var(--glass);
      backdrop-filter: blur(8px) saturate(1.2);
      border-radius:18px;
      padding:26px;
      max-width:760px;
      box-shadow: 0 10px 30px rgba(15,15,20,0.12);
      transform-origin:center;
    }

    /* Popup enter/fade with scale */
    .overlay{
      position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
      background:rgba(8,7,15,0.45);z-index:50;opacity:0;pointer-events:none;transition:opacity .35s ease;
    }
    .overlay.show{opacity:1;pointer-events:auto}
    .popup-card.enter{animation:popIn .48s cubic-bezier(.2,.9,.2,1)}
    @keyframes popIn{ from{opacity:0; transform:translateY(12px) scale(.96)} to{opacity:1; transform:translateY(0) scale(1)} }

    /* Typewriter: letter by letter with glow */
    .typewriter{color:#2d3748;font-size:18px;line-height:1.8;white-space:pre-wrap}
    .typewriter .char{opacity:0;display:inline-block;transform:translateY(6px);filter:drop-shadow(0 0 0 rgba(0,0,0,0));}
    .glow{ text-shadow: 0 6px 18px rgba(244,114,182,0.18), 0 0 8px rgba(255,182,193,0.06);}

    /* floating hearts (container being pointer-events:none) */
    .heart{
      position:fixed;bottom:-60px;pointer-events:none;font-size:18px;opacity:0;transform:translateY(0) scale(.9);
      transition:transform 0.6s linear;
      will-change:transform, opacity, left, top;
      z-index:55;
    }

    /* fireworks canvas sits above overlays when active */
    canvas.fireworks{position:fixed;inset:0;z-index:60;pointer-events:none}

    /* buttons */
    .pill{padding:10px 18px;border-radius:999px;border:none;cursor:pointer}
    .btn-primary{background:linear-gradient(90deg,#f472b6,#fb7185);color:white;box-shadow:0 8px 20px rgba(244,114,182,0.18)}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.12);color:white}

    /* small responsive tweaks */
    @media (max-width:640px){
      .handwritten{font-size:30px}
      .popup-card{padding:18px}
    }

  </style>
</head>
<body>

  <!-- Animated background + bokeh + particles container -->
  <div class="animated-bg"></div>
  <div class="bokeh"></div>
  <div id="particles-js" style="position:fixed;inset:0;z-index:-10;pointer-events:none"></div>

  <!-- Optional: subtle vignette -->
  <div style="position:fixed;inset:0;z-index:-5;pointer-events:none;background:radial-gradient(60% 50% at 50% 60%, rgba(255,255,255,0) 0%, rgba(10,10,20,0.06) 100%);mix-blend-mode:multiply"></div>

  <header class="center" style="padding:36px 18px;flex-direction:column;gap:8px">
    <h1 class="handwritten glow" style="font-size:58px;color:#d63384;margin:0">Happy Birthday</h1>
    <div style="color:#6b7280;font-size:18px">
      Selamat ulang tahun untuk wanita terindah dalam hidupku,  
      <b>Ailsa Nadia Cahyawatii</b> üíï
    </div>
  </header>  

  <main style="padding:30px 18px;max-width:1100px;margin:0 auto">
    <section style="text-align:center;margin:20px 0">
      <p style="max-width:760px;margin:0 auto;color:#374151;line-height:1.6">
        Hari ini bukan sekadar tentang ulang tahunmu, tapi tentang seberapa besar arti dirimu di hidupku.  
        Setiap warna, cahaya, dan melodi di halaman ini adalah cara kecilku untuk bilang:  
        <i>kamu layak bahagia, hari ini dan setiap hari setelahnya.</i>  
        Klik tombol di bawah, dan biarkan kejutan kecil ini membisikkan rasa yang tak pernah padam.
        </p>        
      <button id="btnSurprise" class="pill btn-primary" style="margin-top:18px">Klik untuk Kejutan üéÅ</button>
    </section>

    <!-- MEMORIES (images) -->
<section style="margin:30px 0">
  <h2 class="handwritten" style="font-size:30px;color:#d63384;text-align:center">Kenangan Kita</h2>
  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;margin-top:16px">
    <img src="1.jpeg" style="width:100%;height:220px;object-fit:cover;border-radius:14px;box-shadow:0 8px 18px rgba(7,7,20,0.08)" alt="photo1">
    <img src="2.jpeg" style="width:100%;height:220px;object-fit:cover;border-radius:14px;box-shadow:0 8px 18px rgba(7,7,20,0.08)" alt="photo2">
    <img src="3.jpeg" style="width:100%;height:220px;object-fit:cover;border-radius:14px;box-shadow:0 8px 18px rgba(7,7,20,0.08)" alt="photo3">
    <img src="4.jpeg" style="width:100%;height:220px;object-fit:cover;border-radius:14px;box-shadow:0 8px 18px rgba(7,7,20,0.08)" alt="photo4">
    <img src="5.jpeg" style="width:100%;height:220px;object-fit:cover;border-radius:14px;box-shadow:0 8px 18px rgba(7,7,20,0.08)" alt="photo5">
    <img src="6.jpeg" style="width:100%;height:220px;object-fit:cover;border-radius:14px;box-shadow:0 8px 18px rgba(7,7,20,0.08)" alt="photo6">
    <img src="7.jpeg" style="width:100%;height:220px;object-fit:cover;border-radius:14px;box-shadow:0 8px 18px rgba(7,7,20,0.08)" alt="photo7">
    <img src="8.jpeg" style="width:100%;height:220px;object-fit:cover;border-radius:14px;box-shadow:0 8px 18px rgba(7,7,20,0.08)" alt="photo8">
  </div>
</section>


    <!-- MAIN LETTER -->
    <section style="margin:30px 0;background:rgba(255,255,255,0.9);padding:22px;border-radius:16px">
      <h3 class="handwritten" style="font-size:28px;color:#d63384;margin-top:0;text-align:center">Untuk Ailsa Nadia Cahyawatii</h3>
      <div id="loveText" class="typewriter glow" style="color:#374151;font-size:18px;line-height:1.8;padding:8px 6px;">
        Senyummu adalah cahaya yang selalu berhasil menenangkan hatiku, bahkan di hari-hari paling berat.
        Cara kamu bicara, penuh kelembutan dan ketulusan, membuat dunia terasa lebih indah.
        Kebaikanmu, dan hal-hal kecil yang kamu lakukan tanpa sadar, selalu berhasil membuatku jatuh cinta berulang kali.

        Aku masih ingat waktu kita jalan bareng, tertawa tanpa alasan, menikmati waktu tanpa peduli dunia.
        Aku masih ingat saat kita nonton bersama, saling tukar cerita, saling menatap dalam diam.
        Dan aku juga ingat malam-malam panjang ketika kita saling mendengarkan suara satu sama lain sampai akhirnya tertidur.

        Semua kenangan itu bukan hanya cerita, tapi bagian dari hidup yang selalu ingin aku ulang kembali.
        Kamu adalah rumah bagi hatiku, tempat di mana aku merasa tenang dan diterima apa adanya.
        Selamat ulang tahun, cintaku, Ailsa Nadia Cahyawatii.
        Semoga hari ini dan hari-hari berikutnya membawa kebahagiaan sebesar arti dirimu di hidupku.
        Aku mencintaimu dengan cara yang mungkin tidak bisa dijelaskan kata-kata.
      </div>
      <div style="text-align:center;margin-top:12px;color:#6b7280;font-size:14px"> </div>
    </section>
  </main>

  <!-- POPUPS -->
  <div id="popup1" class="overlay" aria-hidden="true">
    <div class="popup-card enter">
      <h2 class="handwritten" style="color:#d63384;margin:0 0 6px 0;font-size:28px">üéâ Surprise!</h2>
      <div id="popup1Text" style="color:#374151;line-height:1.6">
        Setiap kali kamu tersenyum, dunia ini seakan berhenti sesaat.
        Tidak ada yang lebih indah dari melihat kamu bahagia.
        Kamu adalah alasan sederhana dari semua hal baik yang terjadi dalam hidupku.
        Selamat ulang tahun, kamu yang paling aku sayang, Ailsa Nadia Cahyawatii.
      </div>
      <div style="display:flex;gap:10px;justify-content:center;margin-top:14px">
        <button id="popup1Next" class="pill" style="background:#f472b6;color:#fff">Lanjut Kejutan</button>
        <button id="popup1Close" class="pill" style="background:transparent;border:1px solid #e5e7eb">Tutup</button>
      </div>
    </div>
  </div>

  <div id="popup2" class="overlay" aria-hidden="true">
    <div class="popup-card enter">
      <h2 class="handwritten" style="color:#d63384;margin:0 0 6px 0;font-size:28px">üíå Special</h2>
      <div id="popup2Text" style="color:#374151;line-height:1.6;text-align:left">
        Aku tidak pernah menyangka akan menemukan seseorang seistimewa kamu.
        Kamu baik, sabar, lucu, dan tulus dalam segala hal yang kamu lakukan.
      </div>
      <div style="display:flex;gap:10px;justify-content:center;margin-top:14px">
        <button id="popup2Next" class="pill" style="background:#ef476f;color:#fff">Grand Finale</button>
        <button id="popup2Close" class="pill" style="background:transparent;border:1px solid #e5e7eb">Tutup</button>
      </div>
    </div>
  </div>

  <div id="finalPopup" class="overlay" aria-hidden="true" style="align-items:flex-start;padding-top:40px;">
    <canvas class="fireworks" id="fireworksCanvas"></canvas>
    <div class="popup-card enter" style="max-width:920px;color:#0b1020;background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));">
      <h1 class="handwritten" style="font-size:48px;margin:0 0 12px 0;color:#fff;text-shadow:0 6px 26px rgba(0,0,0,0.4)">I Love You Forever</h1>
      <div id="finalText" style="font-size:20px;line-height:1.8;max-width:820px;margin:0 auto;color:#f8f8ff;opacity:0.98">
        Di antara banyak hal yang pernah aku minta pada Tuhan, kamu adalah jawaban terindah yang pernah aku terima.
        Kamu datang tidak dengan janji besar, tapi dengan ketulusan yang membuat segalanya terasa cukup.

        Aku ingin terus bersamamu, melewati waktu, berbagi cerita, dan tumbuh bersama dalam cinta yang sederhana.
        Tidak peduli seberapa jauh hidup membawa kita, hatiku akan selalu menemukan jalan kembali padamu, Ailsa Nadia Cahyawatii.

        Selamat ulang tahun, cintaku.
        Semoga langkahmu selalu dipenuhi cahaya dan kebahagiaan.
        Aku mencintaimu, hari ini, esok, dan selamanya.
      </div>
      <div style="margin-top:18px;display:flex;gap:12px;justify-content:center">
        <button id="finalClose" class="pill btn-primary">Close</button>
        <button id="finalSave" class="pill btn-ghost">Save Image</button>
      </div>
    </div>
  </div>

  <footer style="text-align:center;padding:20px;color:#6b7280">Made with ‚ù§Ô∏è by [Moh Hilmiy Fuadi]</footer>

  <!-- Audio (kept as requested) -->
  <audio id="bgMusic" src="assets/real-love-the-beatles.mp3" preload="auto" loop></audio>

  <script>
    /* ========= BASIC UI HOOKS ========= */
    const btn = document.getElementById('btnSurprise');
    const popup1 = document.getElementById('popup1');
    const popup2 = document.getElementById('popup2');
    const final = document.getElementById('finalPopup');
    const p1Close = document.getElementById('popup1Close');
    const p1Next = document.getElementById('popup1Next');
    const p2Close = document.getElementById('popup2Close');
    const p2Next = document.getElementById('popup2Next');
    const finalClose = document.getElementById('finalClose');
    const finalSave = document.getElementById('finalSave');
    const bgMusic = document.getElementById('bgMusic');

    // Unlock audio on first interaction (browsers require user gesture)
    window.addEventListener('click', ()=> { bgMusic.play().catch(()=>{}); }, {once:true});

    btn.addEventListener('click', ()=>{
      showOverlay(popup1);
      startConfetti(160, 7);
      spawnHearts(18, {spread: 9000});
    });

    p1Close.addEventListener('click', ()=> hideOverlay(popup1));
    p1Next.addEventListener('click', ()=>{
      hideOverlay(popup1);
      setTimeout(()=>{ showOverlay(popup2); startConfetti(200, 8); spawnHearts(26); }, 150);
    });

    p2Close.addEventListener('click', ()=> hideOverlay(popup2));
    p2Next.addEventListener('click', ()=>{
      hideOverlay(popup2);
      setTimeout(()=>{ showOverlay(final); startConfetti(320, 9); spawnHearts(60); startFireworks(); }, 180);
    });

    finalClose.addEventListener('click', ()=>{
      hideOverlay(final);
      stopFireworks();
    });

    finalSave.addEventListener('click', ()=> {
      // simple screenshot: convert popup element to image by drawing canvas snapshot (limited)
      // fallback: instruct user to take screenshot; here we offer a polite alert
      alert('Untuk menyimpan gambar final: tekan PrtSc atau gunakan fitur screenshot browser/OS. Jika mau, aku bisa buatkan fungsi download PNG otomatis (perlu library tambahan).');
    });

    function showOverlay(el){
      el.classList.add('show');
      el.setAttribute('aria-hidden','false');
    }
    function hideOverlay(el){
      el.classList.remove('show');
      el.setAttribute('aria-hidden','true');
    }

    /* ========= PARTICLES BACKGROUND ========= */
    particlesJS('particles-js', {
      particles:{
        number:{value:70,density:{enable:true, value_area:800}},
        color:{value:['#f472b6','#fb7185','#fbcfe8','#c7b3ff']},
        shape:{type:'circle'},
        opacity:{value:0.35},
        size:{value:3, random:true},
        move:{enable:true, speed:0.9, direction:'none', out_mode:'out'}
      },
      retina_detect:true
    });

    /* ========= CONFETTI (ConfettiGenerator) ========= */
    function startConfetti(amount=200, size=6){
      // create a canvas element targetting body, remove after duration
      const canvas = document.createElement('canvas');
      canvas.style.position = 'fixed';
      canvas.style.inset = '0';
      canvas.style.zIndex = 55;
      document.body.appendChild(canvas);
      const settings = { target: canvas, max: amount, size: size, animate: true,
        props: ['circle','square','triangle','line'],
        colors: [[245,124,138],[255,182,193],[255,215,0],[96,165,250],[167,139,250]], clock: 45
      };
      const conf = new ConfettiGenerator(settings);
      conf.render();
      setTimeout(()=>{ conf.clear(); canvas.remove(); }, 7000);
    }

    /* ========= FLOATING HEARTS (improved movement) ========= */
    function spawnHearts(n=20, opts={}){
      for(let i=0;i<n;i++){
        setTimeout(()=> createHeart(opts), Math.random()*900);
      }
    }
    function createHeart(opts={}){
      const h = document.createElement('div');
      h.className = 'heart';
      h.innerText = ['üíó','üíñ','üíù','üíï'][Math.floor(Math.random()*4)];
      const size = 12 + Math.random()*30;
      h.style.fontSize = size + 'px';
      const startLeft = Math.random()*100;
      h.style.left = startLeft + 'vw';
      document.body.appendChild(h);

      // random bezier path using CSS + requestAnimationFrame for better smoothing
      const duration = 8000 + Math.random()*7000;
      const amplitude = 8 + Math.random()*18;
      const endTop = -30 - Math.random()*40;
      h.style.opacity = 1;

      const start = performance.now();
      function frame(t){
        const p = Math.min(1, (t-start)/duration);
        // ease out
        const ease = (--p)*p*p+1;
        const curTop = (1 - ease) * window.innerHeight + endTop;
        const leftOffset = Math.sin((t/400) + (startLeft*3)) * amplitude;
        h.style.transform = `translate(${leftOffset}px, ${- (ease * (window.innerHeight + 120)) }px) scale(${1 + Math.sin(t/200)/8})`;
        h.style.opacity = String(1 - ease + 0.05);
        if(ease < 1) requestAnimationFrame(frame);
        else h.remove();
      }
      requestAnimationFrame(frame);
    }

    /* ========= TYPEWRITER (letter-by-letter, reusable) ========= */
    function runTypewriter(selector, speed=18, initialDelay=300){
      const el = document.querySelector(selector);
      if(!el) return;
      const text = el.textContent.trim();
      el.innerHTML = '';
      const frag = document.createDocumentFragment();
      // create span per character
      for(let i=0;i<text.length;i++){
        const ch = document.createElement('span');
        ch.className = 'char';
        ch.textContent = text[i];
        frag.appendChild(ch);
      }
      el.appendChild(frag);
      // animate
      const chars = el.querySelectorAll('.char');
      chars.forEach((c, i) => {
        const delay = initialDelay + i * speed + Math.random()*8;
        c.style.transition = `opacity .28s ${delay}ms ease, transform .45s ${delay}ms cubic-bezier(.2,.9,.2,1)`;
        setTimeout(()=>{ c.style.opacity = 1; c.style.transform = 'translateY(0)'; }, delay);
      });
    }
    // run on main letter and popups with small delays
    runTypewriter('#loveText', 20, 300);
    setTimeout(()=> runTypewriter('#popup1Text', 16, 120), 600);
    setTimeout(()=> runTypewriter('#popup2Text', 16, 120), 900);
    setTimeout(()=> runTypewriter('#finalText', 18, 250), 1300);

    /* ========= IMPROVED FIREWORKS ========= */
    const fireworks = {
      canvas: null, ctx: null, particles: [], raf: null,
      init(){
        this.canvas = document.getElementById('fireworksCanvas');
        if(!this.canvas) return;
        this.ctx = this.canvas.getContext('2d');
        this.resize();
        window.addEventListener('resize', ()=> this.resize());
      },
      resize(){
        this.canvas.width = window.innerWidth;
        this.canvas.height = window.innerHeight;
      },
      spawn(x, y){
        // shell explosion: create many particles with hue variety
        const hue = Math.random()*360;
        const count = 70 + Math.floor(Math.random()*60);
        for(let i=0;i<count;i++){
          const angle = Math.random()*Math.PI*2;
          const speed = (Math.random()*3.8)+1.2;
          this.particles.push({
            x: x, y: y,
            vx: Math.cos(angle)*speed,
            vy: Math.sin(angle)*speed,
            life: 120 + Math.random()*60,
            size: 1.5 + Math.random()*2.8,
            hue: hue + Math.random()*60 - 30
          });
        }
      },
      update(){
        const ctx = this.ctx;
        ctx.fillStyle = 'rgba(6,4,12,0.12)';
        ctx.fillRect(0,0,this.canvas.width,this.canvas.height);
        for(let i=this.particles.length-1;i>=0;i--){
          const p = this.particles[i];
          p.vy += 0.03; // gravity
          p.x += p.vx;
          p.y += p.vy;
          p.vx *= 0.998;
          p.vy *= 0.998;
          p.life--;
          if(p.life <= 0){ this.particles.splice(i,1); continue; }
          ctx.beginPath();
          ctx.fillStyle = `hsl(${p.hue} 88% ${50 - (p.life/300*20)}%)`;
          ctx.globalCompositeOperation = 'lighter';
          ctx.fillRect(p.x, p.y, p.size, p.size);
        }
      },
      loop(){
        this.update();
        if(this.particles.length > 0) this.raf = requestAnimationFrame(()=> this.loop());
        else this.raf = null;
      },
      startSequence(duration=9000){
        if(!this.canvas) this.init();
        // spawn fireworks periodically across top half
        const spawnInterval = setInterval(()=>{
          const x = Math.random()*this.canvas.width;
          const y = Math.random()*this.canvas.height*0.55 + 40;
          this.spawn(x,y);
          if(!this.raf) this.loop();
        }, 300 + Math.random()*400);
        setTimeout(()=>{ clearInterval(spawnInterval); }, duration);
        // stop fully after duration + buffer
        setTimeout(()=> this.clearAll(), duration + 2200);
      },
      clearAll(){
        if(this.raf) cancelAnimationFrame(this.raf);
        this.particles = [];
        if(this.ctx) this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);
      }
    };
    function startFireworks(){ fireworks.startSequence(10000); }
    function stopFireworks(){ fireworks.clearAll(); }

    /* ========= Utility: small staged confetti + hearts for initial popups ========= */
    function shortCelebration(){
      startConfetti(180,7);
      spawnHearts(22);
    }

    /* ========= small UI flourish: hover on primary button = neon glow ========= */
    document.querySelectorAll('.pill').forEach(btnEl=>{
      btnEl.addEventListener('mouseenter', ()=> btnEl.style.transform = 'translateY(-3px)');
      btnEl.addEventListener('mouseleave', ()=> btnEl.style.transform = 'translateY(0)');
    });

    /* run a small intro drift of hearts to feel lively */
    setTimeout(()=> spawnHearts(6), 1200);

    /* ========= End of script ========= */
  </script>
</body>
</html>
